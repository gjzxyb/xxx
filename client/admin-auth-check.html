<!-- projectId validation script - place at the beginning of admin.html -->
<script src="js/api.js"></script>
<script>
  // Check authentication and projectId before page loads
  if (!isLoggedIn()) {
    window.location.href = '/';
  }

  const urlParams = new URLSearchProps(window.location.search);
  const projectId = urlParams.get('projectId');

  if (!projectId) {
    alert('缺少项目信息，请通过正确的方式访问');
    window.location.href = '/';
  }

  const user = getCurrentUser();
  if (!user || user.role !== 'admin') {
    alert('您没有权限访问此页面');
    window.location.href = '/';
  }
</script>
